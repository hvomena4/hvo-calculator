<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>HVO Dubbing Calculator</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#0a0a0a;--bg2:#141414;--bg3:#1a1a1a;--bg4:#222;--bdr:#2a2a2a;--bdr2:#333;--txt:#fff;--txt2:#a0a0a0;--txt3:#666;--red:#dc2626;--red2:#b91c1c;--green:#22c55e;--blue:#3b82f6}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--txt);line-height:1.6;-webkit-font-smoothing:antialiased}
.wrap{max-width:880px;margin:0 auto;padding:24px 20px 60px}
.hdr{display:flex;align-items:center;justify-content:space-between;padding-bottom:24px;margin-bottom:28px;border-bottom:1px solid var(--bdr)}
.logo{display:flex;align-items:center;gap:14px}
.logo-i{width:46px;height:46px;border-radius:10px;overflow:hidden;flex-shrink:0}
.logo-i img{width:100%;height:100%;object-fit:contain}
.logo-txt{display:flex;flex-direction:column}
.logo-txt h1{font-size:18px;font-weight:700;line-height:1.2;margin:0}
.logo-txt p{font-size:13px;color:var(--txt3);margin:0}
.acc{background:var(--bg2);border:1px solid var(--bdr);border-radius:14px;margin-bottom:12px;overflow:hidden}
.acc-t{width:100%;display:flex;align-items:center;justify-content:space-between;padding:16px 20px;background:0;border:0;color:var(--txt);font:600 15px/1 'Inter',sans-serif;cursor:pointer}
.acc-t:hover{background:var(--bg3)}
.acc-t span:first-child{display:flex;align-items:center;gap:12px}
.acc-arr{font-size:12px;color:var(--txt3);transition:transform .2s}
.acc.open .acc-arr{transform:rotate(180deg)}
.acc-b{display:none;padding:20px;border-top:1px solid var(--bdr)}
.acc.open .acc-b{display:block}
.step{display:flex;gap:16px}
.step-l{display:flex;flex-direction:column;align-items:center}
.step-d{width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:#fff}
.step-d.bl{background:var(--blue)}.step-d.gr{background:var(--green)}
.step-c{width:2px;flex:1;background:var(--bdr2);margin:6px 0;min-height:16px}
.step-x{padding-bottom:20px;flex:1}
.step-x h4{font-size:15px;font-weight:600;margin-bottom:4px}
.step-x p{font-size:14px;color:var(--txt2)}
.step-x .qc{font-size:12px;color:var(--txt3);font-style:italic;margin-top:4px}
.gr2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:600px){.gr2{grid-template-columns:1fr}}
.card{background:var(--bg3);border-radius:10px;padding:18px}
.card h4{font-size:14px;font-weight:600;margin-bottom:14px}
.card ul{list-style:none;font-size:14px}
.card li{margin-bottom:8px;color:var(--txt2)}
.card .fn{font-size:12px;color:var(--txt3);margin-top:14px;padding-top:14px;border-top:1px solid var(--bdr)}
.tabs{display:flex;border-bottom:1px solid var(--bdr2);margin-bottom:16px}
.tab{padding:10px 18px;background:0;border:0;border-bottom:2px solid transparent;color:var(--txt3);font:500 14px 'Inter',sans-serif;cursor:pointer}
.tab.on{color:var(--txt);border-color:var(--red)}
.tp{display:none}.tp.on{display:block}
.tr{margin-bottom:6px}.tr span:first-child{font-weight:600;margin-right:8px}
.tr .bl{color:#60a5fa}.tr .rd{color:#fca5a5}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{padding:14px 12px;text-align:left;border-bottom:1px solid var(--bdr)}
th{color:var(--txt3);font-weight:500;font-size:13px}
.ctr{text-align:center}
.faq{background:var(--bg3);border-radius:6px;margin-bottom:8px;overflow:hidden}
.faq-q{width:100%;padding:14px 16px;background:0;border:0;color:var(--txt);font:500 14px 'Inter',sans-serif;text-align:left;cursor:pointer}
.faq-q:hover{color:#fca5a5}
.faq-a{display:none;padding:0 16px 14px;font-size:14px;color:var(--txt2);white-space:pre-line}
.faq.open .faq-a{display:block}
.calc{margin-top:40px;padding-top:40px;border-top:1px solid var(--bdr)}
.calc-h{text-align:center;margin-bottom:36px}
.calc-h h2{font-size:26px;font-weight:700;margin-bottom:8px}
.calc-h p{font-size:15px;color:var(--txt2)}
.cs{background:var(--bg2);border:1px solid var(--bdr);border-radius:14px;padding:22px;margin-bottom:14px}
.cs.on{border-color:var(--red)}
.cs.hid{display:none}
.cs-h{display:flex;align-items:center;gap:14px;margin-bottom:18px}
.cs-n{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:#fff}
.cs-n.pn{background:var(--red)}.cs-n.dn{background:var(--green)}
.cs-h h3{font-size:15px;font-weight:600}
.spk-g{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
@media(max-width:500px){.spk-g{grid-template-columns:repeat(2,1fr)}}
.spk{padding:18px 12px;background:var(--bg4);border:2px solid transparent;border-radius:10px;color:var(--txt);font:700 18px 'Inter',sans-serif;cursor:pointer}
.spk:hover{background:var(--bdr2)}
.spk.on{background:var(--red);border-color:#fca5a5}
.cust{margin-top:18px;padding:16px;background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.3);border-radius:10px}
.cust p{font-size:14px;color:#fbbf24}
.cust a{color:#fbbf24}
.svc{display:flex;align-items:center;justify-content:space-between;margin-top:20px;flex-wrap:wrap;gap:16px}
.svc-b{display:flex;gap:10px}
.svc-btn{padding:10px 18px;background:var(--bg4);border:0;border-radius:6px;color:var(--txt);font:600 14px 'Inter',sans-serif;cursor:pointer}
.svc-btn:hover{background:var(--bdr2)}
.svc-btn.on{background:var(--red)}
.rate{text-align:right}
.rate .lb{font-size:12px;color:var(--txt3)}
.rate .vl{font-size:22px;font-weight:700;color:var(--red)}
.url-r{display:flex;gap:12px}
@media(max-width:500px){.url-r{flex-direction:column}}
.url-i{flex:1;padding:14px 18px;background:var(--bg3);border:1px solid var(--bdr2);border-radius:10px;color:var(--txt);font:14px 'Inter',sans-serif}
.url-i::placeholder{color:var(--txt3)}
.url-i:focus{outline:0;border-color:var(--red)}
.fetch{padding:14px 28px;background:var(--red);border:0;border-radius:10px;color:#fff;font:600 14px 'Inter',sans-serif;cursor:pointer;white-space:nowrap;min-width:140px;display:flex;align-items:center;justify-content:center;gap:8px}
.fetch:hover{background:var(--red2)}
.fetch:disabled{background:var(--txt3);cursor:not-allowed}
.fetch.done{background:var(--green);pointer-events:none;min-width:50px;padding:14px 16px}
.fetch.done:hover{background:var(--green)}
.err{margin-top:14px;padding:14px;background:rgba(220,38,38,.15);border:1px solid rgba(220,38,38,.4);border-radius:6px;font-size:14px;color:#fca5a5}
.ch-r{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:14px}
.ch-i{display:flex;align-items:center;gap:14px}
.ch-pfp{width:48px;height:48px;border-radius:50%;object-fit:cover;flex-shrink:0}
.ch-i h3{font-size:16px;font-weight:600}
.ch-i p{font-size:13px;color:var(--txt3)}
.ch-i .subs{color:var(--txt2);font-weight:500}
.edit{padding:10px 18px;background:var(--bg4);border:1px solid var(--bdr2);border-radius:6px;color:var(--txt);font:600 13px 'Inter',sans-serif;cursor:pointer}
.lng-h{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.lng-h h3{font-size:15px;font-weight:600}
.lng-v{font-size:28px;font-weight:800;color:var(--red)}
input[type=range]{width:100%;height:8px;background:var(--bg4);border-radius:4px;-webkit-appearance:none;cursor:pointer}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:22px;height:22px;background:var(--red);border-radius:50%;border:3px solid var(--bg)}
.lng-lb{display:flex;justify-content:space-between;font-size:12px;color:var(--txt3);margin-top:6px}
.res{margin-top:8px}
.res-g{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px}
@media(max-width:600px){.res-g{grid-template-columns:1fr}}
.res-c{background:linear-gradient(135deg,var(--bg2),var(--bg));border:1px solid var(--bdr);border-radius:14px;padding:22px}
.res-c h3{font-size:17px;font-weight:700;margin-bottom:18px;display:flex;align-items:center;gap:10px}
.res-c h3.bl{color:#60a5fa}.res-c h3.gr{color:#4ade80}
.res-r{margin-bottom:18px}
.res-row{display:flex;justify-content:space-between;font-size:14px;margin-bottom:10px}
.res-row .lb{color:var(--txt2)}
.res-t{text-align:center;padding:18px;border-radius:10px}
.res-t.bl{background:#2563eb}.res-t.gr{background:#16a34a}
.res-t .sm{font-size:11px;text-transform:uppercase;letter-spacing:1px;opacity:.85;margin-bottom:4px}
.res-t .bg{font-size:30px;font-weight:900}

/* CTA buttons row */
.cta-row{display:flex;gap:12px;margin-bottom:12px}
@media(max-width:500px){.cta-row{flex-direction:column}}
.email-cta{flex:1;padding:18px;background:#fff;border:0;border-radius:14px;color:var(--bg);font:700 16px 'Inter',sans-serif;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px}
.email-cta:hover{background:#e5e5e5}
.schedule-cta{flex:1;padding:18px;background:var(--bg4);border:1px solid var(--bdr2);border-radius:14px;color:var(--txt);font:700 16px 'Inter',sans-serif;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px}
.schedule-cta:hover{background:var(--bdr2)}
.csv-cta{width:100%;padding:14px;background:var(--bg3);border:1px solid var(--bdr2);border-radius:10px;color:var(--txt2);font:600 14px 'Inter',sans-serif;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px}
.csv-cta:hover{background:var(--bg4);color:var(--txt)}

.lngs{margin-top:40px;background:var(--bg2);border:1px solid var(--bdr);border-radius:14px;padding:24px}
.lngs h3{font-size:16px;font-weight:600;margin-bottom:18px}
.lngs-g{display:grid;grid-template-columns:repeat(5,1fr);gap:10px}
@media(max-width:700px){.lngs-g{grid-template-columns:repeat(3,1fr)}}
@media(max-width:450px){.lngs-g{grid-template-columns:repeat(2,1fr)}}
.lc{display:flex;align-items:center;gap:8px;padding:10px 12px;background:var(--bg3);border-radius:6px;font-size:13px}

/* Email Modal */
.em-m{max-width:480px}
.q-sum{background:var(--bg3);border-radius:10px;padding:18px;margin-bottom:20px}
.q-sum h4{font-size:16px;font-weight:600;margin-bottom:14px}
.q-nums{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.q-n .lb{font-size:12px;color:var(--txt3);margin-bottom:4px}
.q-n .vl{font-size:22px;font-weight:700}
.q-n .vl.bl{color:#60a5fa}.q-n .vl.gr{color:#4ade80}
.q-det{font-size:12px;color:var(--txt3);margin-top:14px;padding-top:14px;border-top:1px solid var(--bdr)}
.em-i{width:100%;padding:14px 18px;background:var(--bg3);border:1px solid var(--bdr2);border-radius:10px;color:var(--txt);font:14px 'Inter',sans-serif;margin-bottom:16px}
.em-i::placeholder{color:var(--txt3)}
.em-i:focus{outline:0;border-color:var(--red)}
.send{width:100%;padding:14px;background:var(--red);border:0;border-radius:10px;color:#fff;font:700 15px 'Inter',sans-serif;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px}
.send:hover{background:var(--red2)}
.em-note{font-size:12px;color:var(--txt3);text-align:center;margin-top:14px}
.succ{text-align:center;padding:40px 20px}
.succ-i{width:72px;height:72px;background:var(--green);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:36px;margin:0 auto 20px}
.succ h3{font-size:22px;font-weight:700;margin-bottom:8px}
.succ p{color:var(--txt2)}
.load{position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:2000;display:none;align-items:center;justify-content:center}
.load.open{display:flex}
.load-b{background:var(--bg2);border-radius:14px;padding:40px;text-align:center}
.spin{width:48px;height:48px;border:4px solid var(--red);border-top-color:transparent;border-radius:50%;animation:spin .8s linear infinite;margin:0 auto 20px}
@keyframes spin{to{transform:rotate(360deg)}}
.load-b p{font-weight:600;margin-bottom:6px}
.load-b .sub{font-size:14px;color:var(--txt3)}
.hid{display:none!important}

/* Simple modal */
.emodal{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;background:rgba(0,0,0,.7);backdrop-filter:blur(8px);z-index:999998;display:none;align-items:center;justify-content:center;padding:20px}
.emodal.open{display:flex}
.em-box{background:#141414;border:1px solid #2a2a2a;border-radius:18px;width:100%;max-width:480px;max-height:90vh;overflow:auto}
.em-h{display:flex;align-items:center;justify-content:space-between;padding:20px 24px;border-bottom:1px solid #2a2a2a}
.em-h h3{font-size:18px;font-weight:700;color:#fff}
.em-x{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:0;border:0;color:#a0a0a0;font-size:24px;cursor:pointer;border-radius:6px}
.em-x:hover{background:#222;color:#fff}
.em-body{padding:24px}
</style>
</head>
<body>

<div class="wrap">
<header class="hdr">
<div class="logo">
  <div class="logo-i"><img src="https://firebasestorage.googleapis.com/v0/b/human-voice-over-prod.firebasestorage.app/o/hvo-bordered-png.png?alt=media&token=4b18aef3-bb8f-473d-a6e6-5d18a37e1143" alt="HVO Logo"></div>
  <div class="logo-txt"><h1>Human Voice Over</h1><p>Premium YouTube Dubbing</p></div>
</div>
</header>

<div class="acc" id="a1"><button class="acc-t" onclick="tgl('a1')"><span><span>‚ñ∂Ô∏è</span><span>How It Works</span></span><span class="acc-arr">‚ñº</span></button>
<div class="acc-b">
<div class="step"><div class="step-l"><div class="step-d bl">1</div><div class="step-c"></div></div><div class="step-x"><h4 style="font-style:italic">Submit</h4><p>Upload your video. A live dashboard tracks every language in real time.</p></div></div>
<div class="step"><div class="step-l"><div class="step-d bl">2</div><div class="step-c"></div></div><div class="step-x"><h4>Transcribe</h4><p>Accurate English script with speaker labels + time codes.</p></div></div>
<div class="step"><div class="step-l"><div class="step-d bl">3</div><div class="step-c"></div></div><div class="step-x"><h4>Translate</h4><p>Native translators adapt line-by-line to sync perfectly.</p><div class="qc">(QC check)</div></div></div>
<div class="step"><div class="step-l"><div class="step-d bl">4</div><div class="step-c"></div></div><div class="step-x"><h4>Record</h4><p>Pro voice actors dub while watching the video to match energy + timing.</p><div class="qc">(QC check)</div></div></div>
<div class="step"><div class="step-l"><div class="step-d bl">5</div><div class="step-c"></div></div><div class="step-x"><h4>Sound Engineer</h4><p>Mix + master so voices blend seamlessly with music + effects.</p><div class="qc">(QC check)</div></div></div>
<div class="step"><div class="step-l"><div class="step-d gr">6</div></div><div class="step-x"><h4 style="font-style:italic;color:#4ade80">We Deliver</h4><p>Final dubs, quality-checked and organized, ready to publish.</p><div class="qc">(3rd-party QC)</div></div></div>
</div></div>

<div class="acc" id="a2"><button class="acc-t" onclick="tgl('a2')"><span><span>üåê</span><span>Audio Track vs Separate Channels</span></span><span class="acc-arr">‚ñº</span></button>
<div class="acc-b"><div class="gr2">
<div class="card"><h4 style="color:#22c55e">Audio Track Feature (Recommended)</h4><ul><li>‚úì All languages in one place</li><li>‚úì Upload all at once when video releases</li><li>‚úì International views boost main channel</li><li>‚úì Current viewers unaffected</li></ul><div class="fn">Requires 40-50 uploads with audio tracks</div></div>
<div class="card"><h4 style="color:#f59e0b">Separate Channels</h4><ul><li>‚úì Faster monetization</li><li>‚úì Easier algorithm discovery</li></ul><ul style="margin-top:12px;color:#666"><li>‚úó Manage each channel yourself</li><li>‚úó No channel management from HVO</li></ul></div>
</div></div></div>

<div class="acc" id="a3"><button class="acc-t" onclick="tgl('a3')"><span><span>‚è±Ô∏è</span><span>Turnaround Speeds</span></span><span class="acc-arr">‚ñº</span></button>
<div class="acc-b">
<p style="color:#22c55e;font-size:14px;margin-bottom:18px">‚úì Flexible and can be adjusted to fit your upload schedule.</p>
<h4 style="font-weight:600;margin-bottom:12px">Ongoing Videos</h4>
<div class="card" style="margin-bottom:18px">
<div class="tabs"><button class="tab on" onclick="stab(event,'t1')">‚â§ 30 Min</button><button class="tab" onclick="stab(event,'t2')">‚â§ 60 Min</button><button class="tab" onclick="stab(event,'t3')">‚â§ 90 Min</button></div>
<div id="t1" class="tp on"><div class="tr"><span class="bl">Standard</span><span>~7 Days</span></div><div class="tr"><span class="rd">Expedited</span><span>~5 Days</span></div></div>
<div id="t2" class="tp"><div class="tr"><span class="bl">Standard</span><span>~10 Days</span></div><div class="tr"><span class="rd">Expedited</span><span>~7 Days</span></div></div>
<div id="t3" class="tp"><div class="tr"><span class="bl">Standard</span><span>~14 Days</span></div><div class="tr"><span class="rd">Expedited</span><span>~10 Days</span></div></div>
</div>
<h4 style="font-weight:600;margin-bottom:12px">Back Catalog</h4>
<div class="card" style="margin-bottom:18px"><p style="font-size:12px;color:#666;margin-bottom:12px">200-400 Minutes</p><div class="tr"><span class="bl">Standard</span><span>Monthly Delivery</span></div><div class="tr"><span class="rd">Expedited</span><span>Weekly Delivery</span></div></div>
<h4 style="font-weight:600;margin-bottom:12px">YouTube Shorts</h4>
<div class="card"><p style="font-size:14px;color:#a0a0a0">Our studios require a 10-15 minute minimum. Send 10-15 shorts together.</p></div>
</div></div>

<div class="acc" id="a4"><button class="acc-t" onclick="tgl('a4')"><span><span>üí∞</span><span>Pricing Structure</span></span><span class="acc-arr">‚ñº</span></button>
<div class="acc-b">
<table><thead><tr><th>Recurring Speakers</th><th class="ctr">Standard</th><th class="ctr">LipSync</th></tr></thead>
<tbody><tr><td>1-2 voices</td><td class="ctr" style="font-weight:600">$50/min</td><td class="ctr" style="font-weight:600">$80/min</td></tr>
<tr><td>3-4 voices</td><td class="ctr" style="font-weight:600">$55/min</td><td class="ctr" style="font-weight:600">$90/min</td></tr>
<tr><td>5-6 voices</td><td class="ctr" style="font-weight:600">$60/min</td><td class="ctr" style="font-weight:600">$100/min</td></tr>
<tr><td>7+ voices</td><td class="ctr" colspan="2" style="color:#666">Custom - schedule a call</td></tr></tbody></table>
<p style="font-size:13px;color:#666;margin-top:14px">Per minute, per language. Expedited +$5/min.</p>
</div></div>

<div class="acc" id="a5"><button class="acc-t" onclick="tgl('a5')"><span><span>üì§</span><span>Submitting & Receiving Dubs</span></span><span class="acc-arr">‚ñº</span></button>
<div class="acc-b"><div class="gr2">
<div><h4 style="font-weight:600;margin-bottom:12px">What's Needed:</h4><div class="card"><ol style="list-style:decimal;padding-left:18px;font-size:14px;color:#a0a0a0"><li>Video Length</li><li>Release Date</li><li>Titles</li><li>Description</li><li>Video URL</li><li>Background Audio URL</li><li>Notes</li></ol></div></div>
<div><h4 style="font-weight:600;margin-bottom:12px">What's Delivered:</h4><div class="card"><ol style="list-style:decimal;padding-left:18px;font-size:14px;color:#a0a0a0"><li>Translated Titles (SEO)</li><li>Translated Description</li><li>Translated Thumbnail Text</li><li>Dubbed Mixed Audio (.WAV)</li><li>Dubbed Raw Audio (.WAV)</li><li>Translated Subtitles (.SRT)</li><li>English Transcript (.SRT)</li></ol></div></div>
</div></div></div>

<div class="acc" id="a6"><button class="acc-t" onclick="tgl('a6')"><span><span>‚ùì</span><span>F.A.Q</span></span><span class="acc-arr">‚ñº</span></button>
<div class="acc-b" id="faq"></div></div>

<section class="calc">
<div class="calc-h"><h2>Get Your Custom Quote</h2><p>See your backlog cost + estimated ongoing monthly cost</p></div>
<div class="cs on" id="s1"><div class="cs-h"><div class="cs-n pn" id="n1">1</div><h3>How many main speakers appear in your videos?</h3></div><div class="spk-g" id="spkg"></div><div class="cust hid" id="cust"><p>For 7+ recurring speakers, please <a href="https://humanvoiceover.com/meetwithus" target="_blank">schedule a call</a> for custom pricing.</p></div><div class="svc hid" id="svc"><div class="svc-b"><button class="svc-btn on" id="bstd" onclick="sSvc('std')">Standard $<span id="pstd">50</span>/min</button><button class="svc-btn" id="blip" onclick="sSvc('lip')">LipSync $<span id="plip">80</span>/min</button></div><div class="rate"><div class="lb">Your Rate</div><div class="vl">$<span id="rdisp">50</span>/min</div></div></div></div>
<div class="cs hid" id="s2"><div class="cs-h"><div class="cs-n pn" id="n2">2</div><h3>Paste your YouTube channel URL</h3></div><div class="url-r"><input type="text" class="url-i" id="urli" placeholder="https://youtube.com/@YourChannel" oninput="resetFetch()"><button class="fetch" id="fbtn" onclick="doFetch()">Fetch Videos</button></div><div class="err hid" id="errmsg"></div></div>
<div class="cs hid" id="s3"><div class="ch-r"><div class="ch-i"><img id="chpfp" class="ch-pfp" src="" alt=""><div><h3 id="chname">Channel</h3><p><span class="subs" id="chsubs"></span> ¬∑ <span id="selcnt">0</span> videos ¬∑ <span id="selmins">0</span> min</p></div></div><button class="edit" onclick="openVM()">Select Videos</button></div></div>
<div class="cs hid" id="s4"><div class="lng-h"><h3>Languages</h3><div class="lng-v" id="ldisp">1</div></div><input type="range" min="1" max="30" value="1" id="lslider" oninput="uLang(this.value)"><div class="lng-lb"><span>1</span><span>30</span></div></div>
<div class="res hid" id="res">
<div class="res-g">
<div class="res-c"><h3 class="bl">üì¶ Backlog Cost</h3><div class="res-r"><div class="res-row"><span class="lb">Videos Selected</span><span id="rv">0</span></div><div class="res-row"><span class="lb">Source Minutes</span><span id="rsm">0</span></div><div class="res-row"><span class="lb">√ó <span id="rl1">1</span> Languages</span><span><span id="rdm">0</span> min dubbed</span></div><div class="res-row"><span class="lb">Rate</span><span>$<span id="rrt">50</span>/min</span></div></div><div class="res-t bl"><div class="sm">Total Backlog</div><div class="bg" id="rbc">$0</div></div></div>
<div class="res-c"><h3 class="gr">üìà Est. Monthly Ongoing</h3><div class="res-r"><div class="res-row"><span class="lb">Total Videos</span><span id="rrc">0</span></div><div class="res-row"><span class="lb">Avg Video Length</span><span><span id="ral">0</span> min</span></div><div class="res-row"><span class="lb">Avg Monthly Output</span><span><span id="rmm">0</span> min</span></div><div class="res-row"><span class="lb">√ó <span id="rl2">1</span> Languages</span><span><span id="rmd">0</span> min/mo</span></div></div><div class="res-t gr"><div class="sm">Est. Monthly</div><div class="bg" id="rmc">$0/mo</div></div></div>
</div>
<div class="cta-row">
  <button class="email-cta" onclick="openEM()">üìß Email Me This Quote</button>
  <button class="schedule-cta" onclick="scheduleCall()">üìÖ Schedule a Call</button>
</div>
<button class="csv-cta" onclick="exportCSV()">üì• Export Selected Videos (CSV)</button>
</div>
</section>
<section class="lngs"><h3>Top 20 Requested Languages</h3><div class="lngs-g" id="lngsg"></div></section>
</div>

<!-- VIDEO MODAL HOST - Shadow DOM will be attached here -->
<div id="video-modal-host"></div>

<!-- EMAIL MODAL -->
<div class="emodal" id="emodal" onclick="closeEMOut(event)">
  <div class="em-box" onclick="event.stopPropagation()">
    <div class="em-h">
      <h3>Email Your Quote</h3>
      <button class="em-x" onclick="closeEM()">√ó</button>
    </div>
    <div class="em-body" id="eform">
      <div class="q-sum">
        <h4 id="ech">Channel</h4>
        <div class="q-nums">
          <div class="q-n"><div class="lb">Backlog</div><div class="vl bl" id="ebc">$0</div></div>
          <div class="q-n"><div class="lb">Monthly Ongoing</div><div class="vl gr" id="emc">$0/mo</div></div>
        </div>
        <div class="q-det" id="edet"></div>
      </div>
      <input type="email" class="em-i" id="emi" placeholder="you@company.com">
      <button class="send" onclick="sendQ()">üìß Send Quote</button>
      <p class="em-note">We'll email you a summary to share with your team</p>
    </div>
    <div class="em-body hid" id="esucc">
      <div class="succ">
        <div class="succ-i">‚úì</div>
        <h3>Quote Sent!</h3>
        <p>Check your inbox for your personalized quote.</p>
      </div>
    </div>
  </div>
</div>

<!-- SCHEDULE MODAL -->
<div class="emodal" id="smodal" onclick="closeSMOut(event)">
  <div class="em-box" onclick="event.stopPropagation()">
    <div class="em-h">
      <h3>Schedule a Call</h3>
      <button class="em-x" onclick="closeSM()">√ó</button>
    </div>
    <div class="em-body" id="sform">
      <div class="q-sum">
        <h4 id="sch">Channel</h4>
        <div class="q-nums">
          <div class="q-n"><div class="lb">Backlog</div><div class="vl bl" id="sbc">$0</div></div>
          <div class="q-n"><div class="lb">Monthly Ongoing</div><div class="vl gr" id="smc">$0/mo</div></div>
        </div>
        <div class="q-det" id="sdet"></div>
      </div>
      <input type="email" class="em-i" id="semi" placeholder="you@company.com">
      <button class="send" onclick="sendSchedule()">üìÖ Continue to Scheduling</button>
      <p class="em-note">We'll save your quote and open our calendar</p>
    </div>
    <div class="em-body hid" id="ssucc">
      <div class="succ">
        <div class="succ-i">‚úì</div>
        <h3>Opening Calendar...</h3>
        <p>Your quote has been saved.</p>
      </div>
    </div>
  </div>
</div>

<div class="load" id="load"><div class="load-b"><div class="spin"></div><p>Fetching channel videos...</p><p class="sub">This may take 10-30 seconds</p></div></div>

<script>
const PRC={'1-2':{s:50,l:80},'3-4':{s:55,l:90},'5-6':{s:60,l:100}},TIERS=['1-2','3-4','5-6','7+'],
LNGS=[['üá≤üáΩ','Spanish (LATAM)'],['üáßüá∑','Portuguese (BR)'],['üá∑üá∫','Russian'],['üá∏üá¶','Arabic'],['üá´üá∑','French'],['üáªüá≥','Vietnamese'],['üáÆüá≥','Hindi'],['üáÆüá©','Indonesian'],['üáπüá∑','Turkish'],['üáπüá≠','Thai'],['üáßüá©','Bangla'],['üá©üá™','German'],['üáÆüá≥','Punjabi'],['üáÆüáπ','Italian'],['üáØüáµ','Japanese'],['üáµüá∞','Urdu'],['üá∞üá∑','Korean'],['üáµüá±','Polish'],['üáÆüá≥','Tamil'],['üá≥üá±','Dutch']],
FAQS=[["What's a casting?","Before moving forward we will prepare a few voice options for you to confirm in a short clip of your material."],["What languages do you offer?","Albanian, Arabic, Bengali, Chinese, Dutch, French, German, Hindi, Indonesian, Italian, Japanese, Korean, Polish, Portuguese, Russian, Spanish, Thai, Turkish, Vietnamese + more"],["How does ongoing billing work?","We bill you at the end of each month based on your total minute usage per language."],["Will my voice actor stay the same?","Yes, we use the same voice actor(s) for all main recurring speakers."],["Does HVO collect a rev-share?","No"],["Who owns the rights to delivered dubs?","You do. We guarantee the transfer of all ownership rights indefinitely."],["How many studios?","60 locations"],["How many actors?","Around 200 per studio and 500 remote actors"],["How many translators?","600 on hand + 400 extra if needed"],["How many audio engineers?","30 in-house engineers"]];
let S={tier:'',lip:false,rate:0,url:'',name:'',thumb:'',subs:'',back:[],recent:[],sel:new Set(),langs:1,calc:{}};

// Shadow DOM elements
let shadowRoot = null;
let shadowModal = null;
let shadowMbox = null;
let shadowMbody = null;
let shadowVgrid = null;

// Create Shadow DOM for modal (completely isolated from Webflow)
function createShadowModal() {
  const host = document.getElementById('video-modal-host');
  shadowRoot = host.attachShadow({ mode: 'open' });
  
  shadowRoot.innerHTML = `
    <style>
      * { box-sizing: border-box; margin: 0; padding: 0; }
      
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0,0,0,0.8);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        z-index: 999999;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 20px;
        font-family: 'Inter', system-ui, sans-serif;
      }
      
      .modal-overlay.open {
        display: flex;
      }
      
      .modal-box {
        background: #141414;
        border: 1px solid #2a2a2a;
        border-radius: 18px;
        width: 100%;
        max-width: 950px;
        height: 85vh;
        max-height: 85vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        position: relative;
      }
      
      .modal-header {
        flex: 0 0 70px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 24px;
        border-bottom: 1px solid #2a2a2a;
        background: #141414;
      }
      
      .modal-header h3 {
        font-size: 18px;
        font-weight: 700;
        color: #fff;
      }
      
      .modal-header p {
        font-size: 13px;
        color: #666;
        margin-top: 2px;
      }
      
      .header-actions {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      
      .action-btn {
        padding: 8px 14px;
        background: #222;
        border: 0;
        border-radius: 6px;
        color: #fff;
        font: 500 13px 'Inter', sans-serif;
        cursor: pointer;
      }
      
      .action-btn:hover {
        background: #333;
      }
      
      .close-btn {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: 0;
        border: 0;
        color: #a0a0a0;
        font-size: 24px;
        cursor: pointer;
        border-radius: 6px;
      }
      
      .close-btn:hover {
        background: #222;
        color: #fff;
      }
      
      .modal-toolbar {
        flex: 0 0 50px;
        padding: 0 24px;
        border-bottom: 1px solid #2a2a2a;
        display: flex;
        align-items: center;
        gap: 12px;
        background: #141414;
      }
      
      .search-input {
        flex: 1;
        max-width: 280px;
        padding: 8px 12px;
        background: #222;
        border: 1px solid #333;
        border-radius: 6px;
        color: #fff;
        font: 14px 'Inter', sans-serif;
      }
      
      .search-input::placeholder {
        color: #666;
      }
      
      .search-input:focus {
        outline: 0;
        border-color: #dc2626;
      }
      
      .toolbar-label {
        font-size: 13px;
        color: #a0a0a0;
      }
      
      .sort-select {
        padding: 8px 12px;
        background: #222;
        border: 1px solid #333;
        border-radius: 6px;
        color: #fff;
        font: 500 13px 'Inter', sans-serif;
        cursor: pointer;
      }
      
      .modal-body {
        flex: 1;
        overflow-y: auto;
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
        padding: 24px;
        background: #141414;
      }
      
      .modal-footer {
        flex: 0 0 70px;
        padding: 0 24px;
        display: flex;
        align-items: center;
        border-top: 1px solid #2a2a2a;
        background: #141414;
      }
      
      .confirm-btn {
        width: 100%;
        padding: 14px;
        background: #dc2626;
        border: 0;
        border-radius: 10px;
        color: #fff;
        font: 700 15px 'Inter', sans-serif;
        cursor: pointer;
      }
      
      .confirm-btn:hover {
        background: #b91c1c;
      }
      
      .video-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 14px;
      }
      
      @media (max-width: 800px) {
        .video-grid {
          grid-template-columns: repeat(3, 1fr);
        }
      }
      
      @media (max-width: 550px) {
        .video-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }
      
      .video-card {
        border-radius: 10px;
        overflow: hidden;
        cursor: pointer;
        border: 2px solid transparent;
        background: #1a1a1a;
      }
      
      .video-card:hover {
        background: #222;
        border-color: #333;
      }
      
      .video-card.selected {
        border-color: #dc2626;
        background: rgba(220,38,38,0.15);
      }
      
      .video-thumb {
        position: relative;
        aspect-ratio: 16/9;
        background: #1a1a1a;
        overflow: hidden;
      }
      
      .video-thumb img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      
      .video-thumb .placeholder {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, rgba(220,38,38,0.3), #1a1a1a);
        font-size: 28px;
      }
      
      .video-thumb .duration {
        position: absolute;
        bottom: 6px;
        right: 6px;
        padding: 3px 6px;
        background: rgba(0,0,0,0.85);
        border-radius: 4px;
        font-size: 11px;
        font-weight: 600;
        color: #fff;
      }
      
      .video-thumb .checkmark {
        position: absolute;
        top: 8px;
        right: 8px;
        width: 24px;
        height: 24px;
        background: #dc2626;
        border-radius: 50%;
        display: none;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        color: #fff;
      }
      
      .video-card.selected .checkmark {
        display: flex;
      }
      
      .video-info {
        padding: 12px;
      }
      
      .video-info h4 {
        font-size: 13px;
        font-weight: 500;
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        margin-bottom: 6px;
        color: #fff;
      }
      
      .video-info p {
        font-size: 12px;
        color: #666;
      }
    </style>
    
    <div class="modal-overlay" id="shadow-modal">
      <div class="modal-box" id="shadow-mbox">
        <div class="modal-header">
          <div>
            <h3>Select Backlog Videos</h3>
            <p><span id="shadow-mcnt">0</span> selected ¬∑ <span id="shadow-mmins">0</span> min</p>
          </div>
          <div class="header-actions">
            <button class="action-btn" id="shadow-selall">Select All</button>
            <button class="action-btn" id="shadow-clear">Clear</button>
            <button class="close-btn" id="shadow-close">√ó</button>
          </div>
        </div>
        <div class="modal-toolbar">
          <input type="text" class="search-input" id="shadow-search" placeholder="Search videos...">
          <span class="toolbar-label">Sort by:</span>
          <select class="sort-select" id="shadow-sort">
            <option value="views">Most Views</option>
            <option value="duration">Longest First</option>
            <option value="newest">Newest First</option>
            <option value="oldest">Oldest First</option>
          </select>
        </div>
        <div class="modal-body" id="shadow-mbody">
          <div class="video-grid" id="shadow-vgrid"></div>
        </div>
        <div class="modal-footer">
          <button class="confirm-btn" id="shadow-confirm">Confirm Selection</button>
        </div>
      </div>
    </div>
  `;
  
  shadowModal = shadowRoot.getElementById('shadow-modal');
  shadowMbox = shadowRoot.getElementById('shadow-mbox');
  shadowMbody = shadowRoot.getElementById('shadow-mbody');
  shadowVgrid = shadowRoot.getElementById('shadow-vgrid');
  
  shadowRoot.getElementById('shadow-close').addEventListener('click', closeVM);
  shadowRoot.getElementById('shadow-selall').addEventListener('click', selAll);
  shadowRoot.getElementById('shadow-clear').addEventListener('click', clrAll);
  shadowRoot.getElementById('shadow-confirm').addEventListener('click', confV);
  shadowRoot.getElementById('shadow-search').addEventListener('input', (e) => filterVideos(e.target.value));
  shadowRoot.getElementById('shadow-sort').addEventListener('change', (e) => sortVideos(e.target.value));
  shadowModal.addEventListener('click', (e) => {
    if (e.target === shadowModal) closeVM();
  });
}

document.addEventListener('DOMContentLoaded',()=>{
createShadowModal();
const sg=document.getElementById('spkg');TIERS.forEach(t=>{const b=document.createElement('button');b.className='spk';b.textContent=t;b.onclick=()=>sTier(t);sg.appendChild(b)});
const fq=document.getElementById('faq');FAQS.forEach(f=>{const d=document.createElement('div');d.className='faq';d.innerHTML=`<button class="faq-q" onclick="this.parentElement.classList.toggle('open')">${f[0]}</button><div class="faq-a">${f[1]}</div>`;fq.appendChild(d)});
const lg=document.getElementById('lngsg');LNGS.forEach(l=>{const d=document.createElement('div');d.className='lc';d.innerHTML=`<span>${l[0]}</span><span>${l[1]}</span>`;lg.appendChild(d)});
});

function tgl(id){document.getElementById(id).classList.toggle('open')}
function stab(e,id){e.target.parentElement.querySelectorAll('.tab').forEach(t=>t.classList.remove('on'));e.target.classList.add('on');e.target.parentElement.parentElement.querySelectorAll('.tp').forEach(p=>p.classList.remove('on'));document.getElementById(id).classList.add('on')}
function sTier(t){S.tier=t;document.querySelectorAll('.spk').forEach((b,i)=>b.classList.toggle('on',TIERS[i]===t));if(t==='7+'){document.getElementById('cust').classList.remove('hid');document.getElementById('svc').classList.add('hid');document.getElementById('s2').classList.add('hid');return}document.getElementById('cust').classList.add('hid');document.getElementById('svc').classList.remove('hid');document.getElementById('s2').classList.remove('hid');document.getElementById('s2').classList.add('on');const p=PRC[t];document.getElementById('pstd').textContent=p.s;document.getElementById('plip').textContent=p.l;S.rate=S.lip?p.l:p.s;document.getElementById('rdisp').textContent=S.rate;document.getElementById('n1').textContent='‚úì';document.getElementById('n1').className='cs-n dn';uRes()}
function sSvc(t){S.lip=t==='lip';document.getElementById('bstd').classList.toggle('on',!S.lip);document.getElementById('blip').classList.toggle('on',S.lip);const p=PRC[S.tier];S.rate=S.lip?p.l:p.s;document.getElementById('rdisp').textContent=S.rate;uRes()}
function resetFetch(){const btn=document.getElementById('fbtn');if(btn.classList.contains('done')){btn.className='fetch';btn.innerHTML='Fetch Videos';btn.disabled=false}}

async function doFetch(){
  const url=document.getElementById('urli').value.trim();
  if(!url)return;
  document.getElementById('load').classList.add('open');
  document.getElementById('errmsg').classList.add('hid');
  document.getElementById('fbtn').disabled=true;
  
  try{
    const r=await fetch('https://n8n.srv962989.hstgr.cloud/webhook/hvo-youtube-fetch',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({channelUrl:url})
    });
    if(!r.ok)throw new Error('HTTP '+r.status);
    const d=await r.json();
    if(!d.backlogVideos||d.backlogVideos.length===0)throw new Error('No videos found');
    
    S.url=url;
    S.name=d.channelName||'Channel';
    S.thumb=d.channelThumb||'';
    S.subs=d.subscriberCount||'';
    S.back=d.backlogVideos||[];
    S.recent=d.recentVideos||[];
    S.sel=new Set(S.back.map(v=>v.id));
    
    document.getElementById('chname').textContent=S.name;
    document.getElementById('chpfp').src=S.thumb;
    document.getElementById('chsubs').textContent=S.subs+' subscribers';
    document.getElementById('fbtn').className='fetch done';
    document.getElementById('fbtn').innerHTML='‚úì';
    document.getElementById('fbtn').disabled=true;
    document.getElementById('n2').textContent='‚úì';
    document.getElementById('n2').className='cs-n dn';
    document.getElementById('s3').classList.remove('hid');
    document.getElementById('s4').classList.remove('hid');
    document.getElementById('res').classList.remove('hid');
    
    rVG();
    uRes();
  }catch(e){
    document.getElementById('errmsg').textContent=e.message;
    document.getElementById('errmsg').classList.remove('hid');
  }finally{
    document.getElementById('load').classList.remove('open');
    document.getElementById('fbtn').disabled=false;
  }
}

function uLang(v){S.langs=parseInt(v);document.getElementById('ldisp').textContent=v;uRes()}
function uRes(){if(S.back.length===0)return;const sv=S.back.filter(v=>S.sel.has(v.id)),bsec=sv.reduce((s,v)=>s+v.duration,0),bmin=Math.round(bsec/60),bdub=bmin*S.langs,bcost=bdub*S.rate;
const allDates=S.back.map(v=>new Date(v.publishedAt)).filter(d=>!isNaN(d));
let monthsActive=1;
if(allDates.length>1){
  const oldest=new Date(Math.min(...allDates));
  const newest=new Date(Math.max(...allDates));
  monthsActive=Math.max(1,Math.round((newest-oldest)/(1000*60*60*24*30)));
}
const totalMins=Math.round(S.back.reduce((s,v)=>s+v.duration,0)/60);
const avgMonthlyMins=Math.round(totalMins/monthsActive);
const avgLen=S.back.length>0?Math.round(totalMins/S.back.length):0;
const mdub=avgMonthlyMins*S.langs;
const mcost=mdub*S.rate;
S.calc={bcost,mcost,bmin,bdub,avgMonthlyMins,mdub,avgLen,monthsActive};document.getElementById('selcnt').textContent=S.sel.size;document.getElementById('selmins').textContent=bmin.toLocaleString();document.getElementById('rv').textContent=S.sel.size;document.getElementById('rsm').textContent=bmin.toLocaleString();document.getElementById('rl1').textContent=S.langs;document.getElementById('rdm').textContent=bdub.toLocaleString();document.getElementById('rrt').textContent=S.rate;document.getElementById('rbc').textContent=fCur(bcost);document.getElementById('rrc').textContent=S.back.length+' over '+monthsActive+' mo';document.getElementById('ral').textContent=avgLen;document.getElementById('rmm').textContent=avgMonthlyMins;document.getElementById('rl2').textContent=S.langs;document.getElementById('rmd').textContent=mdub.toLocaleString();document.getElementById('rmc').textContent=fCur(mcost)+'/mo'}
function fCur(n){return n>=1e6?'$'+(n/1e6).toFixed(2)+'M':n>=1e3?'$'+Math.round(n/1e3).toLocaleString()+'K':'$'+n.toLocaleString()}
function fDur(s){const h=Math.floor(s/3600),m=Math.floor((s%3600)/60),sec=s%60;return h>0?`${h}:${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`:`${m}:${String(sec).padStart(2,'0')}`}
function fDurMin(s){return Math.round(s/60)}
function esc(s){const d=document.createElement('div');d.textContent=s;return d.innerHTML}

function sortVideos(sortBy) {
  if (sortBy === 'views') S.back.sort((a,b) => b.viewCount - a.viewCount);
  else if (sortBy === 'duration') S.back.sort((a,b) => b.duration - a.duration);
  else if (sortBy === 'newest') S.back.sort((a,b) => new Date(b.publishedAt) - new Date(a.publishedAt));
  else if (sortBy === 'oldest') S.back.sort((a,b) => new Date(a.publishedAt) - new Date(b.publishedAt));
  rVG();
}

function rVG(){
  shadowVgrid.innerHTML='';
  S.back.forEach(v=>{
    const c=document.createElement('div');
    c.className='video-card'+(S.sel.has(v.id)?' selected':'');
    c.dataset.id=v.id;
    c.addEventListener('click', () => togV(v.id));
    c.innerHTML=`<div class="video-thumb">${v.thumbnail?`<img src="${v.thumbnail}" loading="lazy">`:'<div class="placeholder">‚ñ∂</div>'}<div class="duration">${fDur(v.duration)}</div><div class="checkmark">‚úì</div></div><div class="video-info"><h4>${esc(v.title)}</h4><p>${v.views} ¬∑ ${v.publishedAgo}</p></div>`;
    shadowVgrid.appendChild(c)
  });
  uMC();
}

function togV(id){
  S.sel.has(id)?S.sel.delete(id):S.sel.add(id);
  const c=shadowVgrid.querySelector(`.video-card[data-id="${id}"]`);
  if(c)c.classList.toggle('selected',S.sel.has(id));
  uMC();
}

function selAll(){
  S.sel=new Set(S.back.map(v=>v.id));
  shadowVgrid.querySelectorAll('.video-card').forEach(c=>c.classList.add('selected'));
  uMC();
}

function clrAll(){
  S.sel.clear();
  shadowVgrid.querySelectorAll('.video-card').forEach(c=>c.classList.remove('selected'));
  uMC();
}

function uMC(){
  const sv=S.back.filter(v=>S.sel.has(v.id));
  const m=Math.round(sv.reduce((s,v)=>s+v.duration,0)/60);
  shadowRoot.getElementById('shadow-mcnt').textContent=S.sel.size;
  shadowRoot.getElementById('shadow-mmins').textContent=m.toLocaleString();
}

function openVM(){
  shadowModal.classList.add('open');
  shadowRoot.getElementById('shadow-search').value='';
  document.body.style.overflow='hidden';
  shadowMbody.scrollTop = 0;
}

function closeVM(){
  shadowModal.classList.remove('open');
  document.body.style.overflow='';
}

function filterVideos(q){
  const lq=q.toLowerCase();
  shadowVgrid.querySelectorAll('.video-card').forEach(c=>{
    const t=c.querySelector('h4').textContent.toLowerCase();
    c.style.display=t.includes(lq)?'':'none';
  });
}

function confV(){closeVM();uRes()}

// Email Modal
function openEM(){
  document.getElementById('ech').textContent=S.name;
  document.getElementById('ebc').textContent=fCur(S.calc.bcost);
  document.getElementById('emc').textContent=fCur(S.calc.mcost)+'/mo';
  document.getElementById('edet').textContent=`${S.sel.size} videos ¬∑ ${S.langs} languages ¬∑ ${S.tier} speakers ¬∑ ${S.lip?'LipSync':'Standard'} @ $${S.rate}/min`;
  document.getElementById('eform').classList.remove('hid');
  document.getElementById('esucc').classList.add('hid');
  document.getElementById('emodal').classList.add('open');
  document.body.style.overflow='hidden';
}
function closeEM(){document.getElementById('emodal').classList.remove('open');document.body.style.overflow=''}
function closeEMOut(e){if(e.target===document.getElementById('emodal'))closeEM()}

async function sendQ(){
  const em=document.getElementById('emi').value.trim();
  if(!em)return;
  try{
    await fetch('https://n8n.srv962989.hstgr.cloud/webhook/hvo-quote-submit',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({
        channelName:S.name,
        channelUrl:S.url,
        email:em,
        speakerTier:S.tier,
        serviceType:S.lip?'LipSync':'Standard',
        languages:S.langs,
        rate:S.rate,
        backlogVideos:S.sel.size,
        backlogSourceMinutes:S.calc.bmin,
        backlogDubbedMinutes:S.calc.bdub,
        backlogCost:S.calc.bcost,
        totalVideos:S.back.length,
        avgVideoLength:S.calc.avgLen,
        avgMonthlyMinutes:S.calc.avgMonthlyMins,
        avgMonthlyDubbed:S.calc.mdub,
        avgMonthlyRate:S.calc.mcost,
        monthsActive:S.calc.monthsActive,
        action:'email'
      })
    });
  }catch(e){console.error(e)}
  document.getElementById('eform').classList.add('hid');
  document.getElementById('esucc').classList.remove('hid');
  setTimeout(closeEM,3000);
}

// Schedule Modal
function scheduleCall(){
  document.getElementById('sch').textContent=S.name;
  document.getElementById('sbc').textContent=fCur(S.calc.bcost);
  document.getElementById('smc').textContent=fCur(S.calc.mcost)+'/mo';
  document.getElementById('sdet').textContent=`${S.sel.size} videos ¬∑ ${S.langs} languages ¬∑ ${S.tier} speakers ¬∑ ${S.lip?'LipSync':'Standard'} @ $${S.rate}/min`;
  document.getElementById('sform').classList.remove('hid');
  document.getElementById('ssucc').classList.add('hid');
  document.getElementById('smodal').classList.add('open');
  document.body.style.overflow='hidden';
}
function closeSM(){document.getElementById('smodal').classList.remove('open');document.body.style.overflow=''}
function closeSMOut(e){if(e.target===document.getElementById('smodal'))closeSM()}

async function sendSchedule(){
  const em=document.getElementById('semi').value.trim();
  if(!em)return;
  try{
    await fetch('https://n8n.srv962989.hstgr.cloud/webhook/hvo-quote-submit',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({
        channelName:S.name,
        channelUrl:S.url,
        email:em,
        speakerTier:S.tier,
        serviceType:S.lip?'LipSync':'Standard',
        languages:S.langs,
        rate:S.rate,
        backlogVideos:S.sel.size,
        backlogSourceMinutes:S.calc.bmin,
        backlogDubbedMinutes:S.calc.bdub,
        backlogCost:S.calc.bcost,
        totalVideos:S.back.length,
        avgVideoLength:S.calc.avgLen,
        avgMonthlyMinutes:S.calc.avgMonthlyMins,
        avgMonthlyDubbed:S.calc.mdub,
        avgMonthlyRate:S.calc.mcost,
        monthsActive:S.calc.monthsActive,
        action:'schedule'
      })
    });
  }catch(e){console.error(e)}
  document.getElementById('sform').classList.add('hid');
  document.getElementById('ssucc').classList.remove('hid');
  setTimeout(()=>{
    closeSM();
    window.open('https://humanvoiceover.com/meetwithus','_blank');
  },1500);
}

// CSV Export
function exportCSV(){
  if(S.sel.size===0)return alert('No videos selected');
  
  const selected = S.back.filter(v=>S.sel.has(v.id));
  const headers = ['Video Title','Link','Length (min)','Views'];
  const rows = selected.map(v=>[
    `"${v.title.replace(/"/g,'""')}"`,
    `https://youtube.com/watch?v=${v.id}`,
    fDurMin(v.duration),
    v.viewCount
  ]);
  
  const csv = [headers.join(','), ...rows.map(r=>r.join(','))].join('\n');
  const blob = new Blob([csv], {type:'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `${S.name.replace(/[^a-z0-9]/gi,'_')}_backlog.csv`;
  a.click();
  URL.revokeObjectURL(url);
}
</script>
</body>
</html>
